# MidiGenshinMusicPlayer
# 操作指南
## 按键操作列表
### 播放状态
#### 按 F8 切换 暂停 或 播放
### 切换乐谱
#### 按 F7 键播放上一个乐谱。
#### 按 F9 键播放下一个乐谱。
### 播放模式
按 F10 键切换播放模式：
#### 单次播放：每次播放完毕后停止。
#### 单曲循环：当前乐谱循环播放。
#### 目录循环：循环播放整个文件夹中的所有乐谱。
### 显示设置
#### 按 [ ↑ ] up键 (向上箭头键) 增加乐谱显示数量。
#### 按 [ ↓ ] down键 (向下箭头键) 减少乐谱显示数量。
#### 按 [ ← ] left键 (向左箭头键) 减少当前显示的乐谱列表数量。
#### 按 [ → ] right键 (向右箭头键) 增加当前显示的乐谱列表数量。

## 命令行界面
#### 界面显示
#### 程序启动后会显示当前的乐谱文件夹路径、当前乐谱名称、播放状态（播放/暂停）以及当前显示的乐谱列表。
#### 当播放状态改变时，界面会更新显示状态。

## 操作方法
### 演奏前的准备操作：
#### 1.右键程序
#### 2.以“管理员身份运行”MidiGenshinMusicPlayer.exe。
#### 3.启动程序后，按 F6 键来选择包含MIDI文件的文件夹；选择完成后，程序会列出文件夹中的所有MIDI文件供您选择自动演奏；默认第一个.mid文件会被“[]”标记为“当前乐谱”。
### 开始播放的操作：
#### 4.用 F7 或 F9 选择好一个MIDI文件
#### 5.点击《原神》的窗口，使Windows系统的窗口焦点在《原神》的游戏窗口上
#### 6.在《原神》中使用你想用于演奏该乐谱的音乐道具：“风物之诗琴”、“老旧的诗琴”、“镜花之琴”、“晚风圆号”等
#### 7.按 F8 键开始演奏当前乐谱。
#### //在播放过程中，可以通过按 F8 键再次切换暂停或播放的状态。
#### //[单次播放]模式停止播放后，需两次按下F8以重新进入播放状态(该bug等待修复中
#### //[单次播放]模式下播放结束后，程序默认进入暂停状态。


## 注意事项
#### midi文件所在的文件路径以及midi文件的文件名不得包含中文，否则会导致显示乱码以及程序崩溃(发生在试图播放 文件名乱码 的.mid文件时 以及 文件路径 中 包含中文 时播放任意.mid文件)
#### 程序需要以管理员权限运行，以便正确捕获键盘事件。
#### 在播放过程中，保持《原神》游戏处于前台运行状态，以便正确模拟乐器演奏动作。
#### 如果releases发行的版本无法运行请下源代码载到本地用Visual Studio2022编译
#### 编译时的设置如下图所示
![输入图片说明](README_Photos/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-07-22%20112814.png)
##### 附加包含目录 指向的 include文件夹 的路径请根据该文件夹的实际位置自行修改
![include文件夹的路径可能需要手动修改](README_Photos/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-07-22%20112849.png)
![res文件夹内的文件如果没有自动导入的话就在资源文件那里手动导入现有项](README_Photos/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-07-22%20113423.png)
#### releases发行的版本不是所有Windows版本可用
#### 杀毒软件报毒的话添加信任就行，因为代码中有WindowsAPI的调用，报毒是正常的

## 修改乐谱注意事项
### 1.自己下载的Midi文件最好用MuseScore改为C大调
![输入图片说明](README_Photos/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-07-22%20115231.png)
![输入图片说明](README_Photos/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-07-22%20115245.png)
![输入图片说明](README_Photos/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-07-22%20115256.png)
### 2.然后适当修改，如果有升降调的音符和超出原神琴的21个音的音符会被忽略
![输入图片说明](README_Photos/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-07-22%20115015.png)
